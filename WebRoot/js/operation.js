/**
#---------------------------------------------------------------------------------------
#           EMAIL???hersh@ffcs.cn
#           OICQ???45888806
#           MSN???h.r.s@163.com
#           www.flywit.com
#			??????(???)????????????????????????????????????????????????????????????????????????????????????????????????
#---------------------------------------------------------------------------------------
*/
/**######################??????###########################*/
/**
*	????????????
*	formname???????????????,listCheckboxName???Checkbox????????????,action???????????????URL
*/
function fwPaginated(formname,action){
	var form = window.document.getElementById(formname);
	form.action = action;
	form.submit();
}
/**######################??????????????????###########################*/

function fwGoToUrlByID(url,id){
	if(id==null || url==null){
		alert("fwGoToUrlByKey(url,id),??????url???id???????????????");
		return;
	}
	window.location.href = url + "?id=" + id;
}

function fwGoToUrl(url){
	window.location.href = url;
}

//????????????
function fwAdd(url){
	window.location.href = url;
}

function fwDeleteByUrl(url,id){

	if(id==null || url==null){
		alert("fwDeleteByUrl(url,id),??????url???id???????????????");
		return;
	}
	
	if(confirm("?????????????????????????")!=true){
		return;
	}
	window.location.href = url + "?id=" + id;
}

function fwModifyByUrl(url,id){
	if(id==null || url==null){
		alert("fwModifyByUrl(url,id),??????url???id???????????????");
		return;
	}
	window.location.href = url + "?id=" + id;
}
function fwAddByUrl(url,id){
	if(id==null || url==null){
		alert("fwAddByUrl(url,id),??????url???id???????????????");
		return;
	}
	window.location.href = url + "?id=" + id;
}

function fwGoToUrlByIDOpen(url,winName,width,height) { 
	window.open(url,winName,'left=100,top=100,scrollbars=yes,width="+width+",height="+height+"');
} 

/**
*	?????????URL??????(???????????????)
*	listCheckboxName???Checkbox????????????,url???????????????URL
*/
function fwGoToURLByCheckboxOpen(listCheckboxName,url,parametername,winName,width,height){
	var selectCount = fwIsMultiSelectCheckbox(listCheckboxName);
	if(selectCount==0){
		alert("??????????????????????????????");
		return;
	}
	if(selectCount>1){
		alert("????????????????????????????????????");
		return;
	}
	var value = fwGetSelectCheckbox(listCheckboxName);
	
	window.open(url + "?" + parametername + "=" + value,winName,'left=100,top=50,scrollbars=yes,width="+width+",height="+height+"');
}

/**######################?????????????????????checkbox???###########################*/

/**
*	??????URL??????
*	listCheckboxName???Checkbox????????????,url???????????????URL
*/
function fwGoToPutURLByCheckbox(listCheckboxName){
	var selectCount = fwIsMultiSelectCheckbox(listCheckboxName);
	if(selectCount==0){
		alert("??????????????????????????????");
		return;
	}
	if(selectCount>1){
		alert("????????????????????????????????????");
		return;
	}
	var value = fwGetSelectCheckbox(listCheckboxName);
	window.location.href = value;
}

/**
*	?????????URL??????
*	listCheckboxName???Checkbox????????????,url???????????????URL
*/
function fwGoToURLByCheckbox(listCheckboxName,url){
	var selectCount = fwIsMultiSelectCheckbox(listCheckboxName);
	//alert(listCheckboxName);
	//alert(url);
	if(selectCount==0){
		alert("??????????????????????????????");
		return;
	}
	if(selectCount>1){
		alert("????????????????????????????????????");
		return;
	}
	var value = fwGetSelectCheckbox(listCheckboxName);
	window.location.href = url + "?id=" + value;
}

/**
*	????????????URL??????
*	listCheckboxName???Checkbox????????????,url???????????????URL
*/
function fwGoToParamURLByCheckbox(listCheckboxName,url){
	var selectCount = fwIsMultiSelectCheckbox(listCheckboxName);
	if(selectCount==0){
		alert("??????????????????????????????");
		return;
	}
	if(selectCount>1){
		alert("????????????????????????????????????");
		return;
	}
	var value = fwGetSelectCheckbox(listCheckboxName);
	window.location.href = url + "&id=" + value;
}

/**
*	????????????
*	listCheckboxName???Checkbox????????????,url???????????????URL
*/
function fwModifyByCheckbox(listCheckboxName,url){
	var selectCount = fwIsMultiSelectCheckbox(listCheckboxName);
    var vvv = fwGetSelectCheckbox(listCheckboxName);
    vvv = vvv.substring(0,2);
    if (vvv == '-1' || vvv == '0&'){
       alert("?????????????????????,???????????????!");
		return;
    }
    
    //alert(vvv);
	if(selectCount==0){
		alert("??????????????????????????????");
		return;
	}
	if(selectCount>1){
		alert("????????????????????????????????????");
		return;
	}
	
	var value = fwGetSelectCheckbox(listCheckboxName);
	window.location.href = url + "?id=" + value;
}
//????????????
function fwAddByCheckbox(listCheckboxName,url){
	var selectCount = fwIsMultiSelectCheckbox(listCheckboxName);
	if(selectCount==0){
		alert("??????????????????????????????");
		return;
	}
	if(selectCount>1){
		alert("????????????????????????????????????");
		return;
	}
	var value = fwGetSelectCheckbox(listCheckboxName);
	window.location.href = url + "?id=" + value;
}

/**
*	????????????
*	formname???????????????,listCheckboxName???Checkbox????????????,action???????????????URL
*/
function fwDeleteByCheckbox(formname,listCheckboxName,action){

	var selectCount = fwIsMultiSelectCheckbox(listCheckboxName);
	var vvv = fwGetSelectCheckbox(listCheckboxName);
    vvv = vvv.substring(0,2);
    if (vvv == '-1' || vvv == '0&'){
       alert("?????????????????????,???????????????!");
		return;
    }
	if(selectCount==0){
		alert("??????????????????????????????");
		return;
	}
	
	if(confirm("?????????????????????????")!=true){
		return;
	}	
	var form = window.document.getElementById(formname);
	form.action = action;
	form.submit();
}

/**
*	????????????
*	formname???????????????,listCheckboxName???Checkbox????????????,action???????????????URL
*/
function fwGoToUrlByCheckbox(formname,listCheckboxName,action){

	var selectCount = fwIsMultiSelectCheckbox(listCheckboxName);
	if(selectCount==0){
		alert("??????????????????????????????");
		return;
	}
	
	var form = window.document.getElementById(formname);
	form.action = action;
	form.submit();
}

function fwLockByCheckbox(formname,listCheckboxName,action){

	var selectCount = fwIsMultiSelectCheckbox(listCheckboxName);
	if(selectCount==0){
		alert("????????????????????????????????????");
		return;
	}
	
	if(confirm("??????????????????????????????????")!=true){
		return;
	}	
	var form = window.document.getElementById(formname);
	form.action = action;
	form.submit();
}

function fwUnLockByCheckbox(formname,listCheckboxName,action){

	var selectCount = fwIsMultiSelectCheckbox(listCheckboxName);
	if(selectCount==0){
		alert("??????????????????????????????????????????");
		return;
	}
	
	if(confirm("????????????????????????????????????????")!=true){
		return;
	}	
	var form = window.document.getElementById(formname);
	form.action = action;
	form.submit();
}

/**
*	????????????
*	formname???????????????,listCheckboxName???Checkbox????????????,action???????????????URL
*/
function fwDeleteByCheckboxParameter(listCheckboxName,action){

	var selectCount = fwIsMultiSelectCheckbox(listCheckboxName);
	if(selectCount==0){
		alert("??????????????????????????????");
		return;
	}
	
	if(confirm("?????????????????????????")!=true){
		return;
	}	
	var value = fwGetSelectCheckbox(listCheckboxName);
	window.location.href = url + "?id=" + value;
}

/**
*	????????????
*	formname???????????????,listCheckboxName???Checkbox????????????,action???????????????URL,nullTitle:????????????
*/
function fwShowByCheckbox(formname,listCheckboxName,action,nullTitle){
	var selectCount = fwIsMultiSelectCheckbox(listCheckboxName);
	if(selectCount==0){
		alert(nullTitle);
		return;
	}
	var form = window.document.getElementById(formname);
	form.action = action;
	form.submit();
}

//????????????????????????checkbox??????
function fwGetSelectCheckbox(listCheckboxName){
	var listCheckbox=document.getElementsByName(listCheckboxName); 
	var value = null;
	for (var i=0; i<listCheckbox.length; i++)
	{			
		if(listCheckbox[i].checked == true){
			value = listCheckbox[i].value;
			break;
		}		
	}
	return value;
	
}

//??????checkbox??????????????????????????????????????????????????????
function fwIsMultiSelectCheckbox(listCheckboxName){
	var listCheckbox=document.getElementsByName(listCheckboxName);
	var selectCount = 0;
	for (var i=0; i<listCheckbox.length; i++)
	{			
		if(listCheckbox[i].checked == true){
			selectCount = selectCount + 1;
		}		
	}
	return selectCount;
	
}

//????????????????????????checkbox???????????????
function fwSetListCheckbox(table,row,listCheckboxName,isMultiSelect, selectedColor,color1,color2){

	//row:??????????????????(table),checkbox?????????
	//chkboxListName:checkbox????????????
	//isMultiSelect:??????????????????
	var isSingleSelect;
	if(isMultiSelect == null) isSingleSelect = true; //???????????????
	else isSingleSelect = !isMultiSelect;
	
	listCheckbox=document.getElementsByName(listCheckboxName)

	var cells = row.cells; //??????????????????tr?????????td??????
	var chkbox = cells[0].childNodes.item(0); //??????checkbox:????????????TD???
	//alert(chkbox.value);
	if(!window.event.ctrlKey || isSingleSelect){
	//??????
		for (var i=0; i<listCheckbox.length; i++)
		{			
			listCheckbox[i].checked = false;	 
			if(i%2==0){
				table.rows[i+1].style.background=color1;
			}else{
				table.rows[i+1].style.background=color2;
			}
			
				
		}
		chkbox.checked = true;	
		row.style.background=selectedColor;
	}
	else{
	//??????Ctrl?????????,????????????
		chkbox.checked = !chkbox.checked;	
		row.style.background=selectedColor;
	
	}
}


/**######################??????????????????checkbox???###########################*/

//??????????????????????????????????????????????????????????????????????????????????????????
function deleteTreeNode(formname,listCheckboxName,action){
	if(getSelectedTreeNode(listCheckboxName,'childCount')>0){
		alert("???????????????????????????,???????????????????????????!");
		return;
	}
	if(getSelectedTreeNode(listCheckboxName,'value')==null){
		alert("???????????????????????????!");
		return;
	}
	
	if(confirm("?????????????????????????")!=true){
		return;
	}	
	var form = window.document.getElementById(formname);
	form.action = action;
	form.submit();
}

//????????????????????????
function getSelectedTreeNode(listCheckboxName,type){
	itemlist=document.getElementsByName(listCheckboxName);
		for (var i=0; i<itemlist.length; i++)
		{
			if (itemlist[i].checked == true)
			{
				if(type=='value') return itemlist[i].value; //??????ID
				if(type=='childCount') return itemlist[i].childCount; //????????????
				if(type=='parent') return itemlist[i].parent; //?????????
				if(type=='depth') return itemlist[i].depth; //??????
				if(type=='variable') return itemlist[i].variable; //??????
			}
		}
	return null;
}

//??????????????????????????????
function getTreeNodeByIndex(listCheckboxName,type,index){
	itemlist=document.getElementsByName(listCheckboxName);
	
	if(type=='value') return itemlist[index].value; //??????ID
	if(type=='childCount') return itemlist[index].childCount; //????????????
	if(type=='parent') return itemlist[index].parent; //?????????
	if(type=='depth') return itemlist[index].depth; //??????
	if(type=='variable') return itemlist[index].variable; //??????

	return null;
}

/**
*	???????????????
*	url???????????????URL
*/
function addTreeNode(url){
	window.location.href = url;
}

/**
*	???????????????
*	listCheckboxName???Checkbox????????????,url???????????????URL
*/
function addChildTreeNode(listCheckboxName,url){
	var value = getSelectedTreeNode(listCheckboxName,'value');
	if(value==null){
		alert("???????????????????????????????????????");
		return false;
	}
	window.location.href = url + "?parent=" + value;
}

/**
*	????????????
*	listCheckboxName???Checkbox????????????,url???????????????URL
*/
function modifyTreeNode(listCheckboxName,url){
	var value = getSelectedTreeNode(listCheckboxName,'value');
	if(value==null) alert("??????????????????????????????");
	else window.location.href = url + "?id=" + value;
}

/**######################??????????????????###########################*/
/**
* ????????????
* formname?????????ID,action?????????URL,submitname?????????????????????ID
*/
function OnSubmit(formname,action,submitname){
	var submitBTN = window.document.getElementById(submitname);
	var form = window.document.getElementById(formname);
	form.action = action;
	//form.submit();  /**??????????????????????????????????????????submit???input??????*/
	submitBTN.click();
} 

function OnSubmitOnlyOnce(formname,action,submitname,savename){
	var submitBTN = window.document.getElementById(submitname);
	var saveBTN = window.document.getElementById(savename);
	saveBTN.disabled = true;
	saveBTN.value = '???????????????...';
	var form = window.document.getElementById(formname);
	form.action = action;
	//form.submit();  /**??????????????????????????????????????????submit???input??????*/
	submitBTN.click();
} 

/**
* ????????????
* resetname?????????????????????ID
*/
function OnReset(resetname){
	var resetBTN = window.document.getElementById(resetname);
	resetBTN.click();
} 

function retDialogOpen(url,width,height) { 
	//????????????
	return window.showModalDialog(url,'','dialogWidth:"+width+"px;dialogHeight:"+height+"px;status:no;dialogHide:true;help:no;scroll:no');
}

function submitForm(formname,action){
	var form = window.document.getElementById(formname);
	form.action = action;
	form.submit();
} 
function callBack(url){
	if(confirm("??????????????????????????????????") == true){
		fwGoToUrl(url)
	}	
}